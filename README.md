# Models to study DC kinetics 
This repository contains the MATLAB scripts used to simulate DC kinetics and to estimate parameters.
 - Model 1: Random entry, exit and proliferation of DCs
 - Model 2: Exit of DCs after fixed residence time, same residence time for all DCs, proliferation rate increases during the stay in the SI
 - Model 3: Exit of DCs after a maximal residence time or before, proliferation rate increases during the stay in the SI
## Executable scripts
 - main_Model1.m: generates fit and simulation of Model 1 shown in Fig. 4C
 - main_Model2.m: generates fit and simulation of Model 2 shown in Fig. 4C
 - main_Model3.m: generates fit and simulation of Model 3 shown in Fig. 4C
 - main_Model3_loop.m: generates fits and simulations of Model 3 shown in Supplementary Fig. 4D
## Scripts containing functions
- obj_Model1.m: weighted least square cost function for fitting of Model 1
- obj_Model2.m: weighted least square cost function for fitting of Model 2
- obj_Model3.m: weighted least square cost function for fitting of Model 3
- photoconverted_Model1.m: function to calculate the fraction of photoconverted cells according to Model 1 (implementation of equation 13)
- photoconverted_Model2.m: function to calculate the fraction of photoconverted cells according to Model 2 (implementation of equation 58)
- photoconverted_Model3.m: function to calculate the fraction of photoconverted cells according to Model 3 (implementation of equation 77)
## Scripts containing data
- dataPC.m: data used for fitting

## Output
- output.zip: zip file containing the output generated by the above scripts (main_Model1.m, main_Model2.m, main_Model3_loop.m). The output was generated by running the code on MATLAB version '24.1.0.2537033 (R2024a)' on Ubuntu 24.04.1 LTS using 11th Gen Intel(R) Core(TM) i7-1165G7 @ 2.80GHz.

## System requirements
- This software requires MATLAB Version R2024a or higher with the 'Optimization Toolbox' and the 'Statistics and Machine Learning Toolbox'.
- The software was tested using MATLAB version '24.1.0.2537033 (R2024a)' on Ubuntu 24.04.1 LTS using 11th Gen Intel(R) Core(TM) i7-1165G7 @ 2.80GHz.
- Non-standard hardware is not required.

## Installation guide
- This software requires MATLAB Version R2024a or higher with the 'Optimization Toolbox' and the 'Statistics and Machine Learning Toolbox', which has to be installed as described by the manufacturer (https://mathworks.com/help/install/install-products.html), typical installation time on a desktop computer depending on the speed of the internet connection (approx. 15 minutes).
- Other installations are not required

## Instructions for use
- Download all files into a directory
- Open MATLAB and switch to the directory where the code is located
- Type the name of the script to be executed (main_Model1.m, main_Model2.m, main_Model3_loop.m) in the MATLAB console and press enter

## Demo & output
- Execute the script main_Model1.m. This script fits Model 1 to the data in the file dataPC.m and generates the plots shown in Fig. 4C. The runtime on a standard desktop computer is less than 5 minutes for 200 multistarts.
- Execute the script main_Model2.m. This script fits Model 2 to the data in the file dataPC.m and generates the plots shown in Fig. 4C. The runtime on a standard desktop computer is less than 5 minutes for 200 multistarts.
- Execute the script main_Model3.m. This script fits Model 3 to the data in the file dataPC.m and generates the plots shown in Fig. 4C. The runtime on a standard desktop computer is less than 5 minutes for 200 multistarts.
- Execute the script main_Model3_loop.m. This script fits Model 3 with different parameter constraints to the data in the file dataPC.m and generates the plots shown in Supplementary Fig. 4C. The runtime on a standard desktop computer is less than 10 minutes for 200 multistarts.
- The outpt generated when running the code on MATLAB version '24.1.0.2537033 (R2024a)' on Ubuntu 24.04.1 LTS using 11th Gen Intel(R) Core(TM) i7-1165G7 @ 2.80GHz is provided in the file output.zip
  
